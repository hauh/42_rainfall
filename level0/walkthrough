# 1. Запустить программу в дебаггере
# 2. Найти сравнение со вводом
# 3. Взять число, с которым сравнивается ввод
# 4. Запустить программу с этим числом и получить пароль

ssh level0@$RAINFALL_IP -p 4242 '
    EXPECTED_NUMBER=$(
        # дизассемблирование
        gdb --batch -ex "disas main" ./level0 |
        # извлечение нужного числа
        grep cmp | awk "{print substr(\$4, 2)}" | cut -d "," -f1
    );
    ./level0 $((EXPECTED_NUMBER)) <<< "cat /home/user/level1/.pass"  # запуск с этим числом и получение пароля
'
